let mainScroll,repoListScroll;function getSearchParams(){if(window.location.search.length>0){let e=window.location.search.replace(/\?/g,"").split("&"),t={};for(let o of e)t[o.match(/.*(?=\=)/g)[0]]=o.match(/(?<=\=).*/g)[0];return t}return null}function getCloneUrl(e,t=null){let o={github_cli:`gh repo clone ${e.git_url}`,ssh:e.ssh_url,https:e.clone_url},n=(t||$(".uk-active").text()).toLowerCase().replace(/\s+/g,"_");$("#clone-url").text(o[n])}function copyCloneURL(){document.execCommand("copy"),UIkit.notification.closeAll(),UIkit.notification({message:'<p class="uk-text-normal uk-text-small uk-text-center p-2 m-0">URL copied to clipboard</p>',status:"success",pos:"bottom-center",timeout:500})}async function setModalContent(e){$("#modal h2, #modal .uk-modal-header p").text(""),$("#modal .uk-modal-body").html('<div uk-spinner class="uk-dark" style="align-self:center"></div>');let t=Object.keys(await(await fetch(e.languages_url)).json()),o=((await(await fetch(`https://api.github.com/repos/dandycheng/${e.name}/git/refs`)).json())[0].object.sha,await(await(await fetch(`https://api.github.com/repos/dandycheng/${e.name}/contents`)).json()));console.log(`https://api.github.com/repos/dandycheng/${e.name}/contents`),$("#modal h2").toggleClass(".placeholder").text(e.name);let n,a=e.description||"No description",l=await(await fetch(`https://raw.githubusercontent.com/dandycheng/${e.name}/${e.default_branch}/README.md`)).text();try{n=await(await fetch(`https://raw.githubusercontent.com/dandycheng/${e.name}/${e.default_branch}/walkthrough.txt`)).text()}catch(e){console.log(e)}let c=l.match(/(?<=\[.*\]\((?!http(s)?)).*(?=\))/g);c&&c.forEach(t=>l=l.replace(t,`https://raw.githubusercontent.com/${e.full_name}/master/${t}`)),setTimeout(()=>{let c=!l.includes("404: Not Found"),s=!n.includes("404: Not Found"),i=e.homepage&&e.homepage.includes("colab.research.google.com");$("#modal .uk-modal-body").html(""),$("#modal .uk-modal-header p").text(a),$("#modal .uk-modal-body").html(`\n            ${t.length>0?'\n                <p class="uk-text-bold p-0 m-0 mb-1">Languages</p>\n                <div class="langs d-flex flex-row flex-wrap"></div>\n            ':""}\n            <p class="uk-text-bold m-0 mt-2 mb-2">Directory tree</p>\n            <div class="d-tree d-flex flex-column m-0"></div>\n            <div class="mt-3">\n                <p class="uk-text-bold d-block m-0">Created at:\n                    <code class="text-dark uk-text">${new Date(e.created_at).toDateString().replace(/(?<=\w+)\s/,", ")}</code>\n                </p>\n                <p class="uk-text-bold d-block m-0">Forked: <code class="text-dark uk-text">${e.fork?"True":"False"}</code></p>\n            </div>\n            <div id="actions" class="d-flex flex-row flex-wrap">\n                <div class="mt-3 uk-button-group uk-text-normal d-flex flex-row flex-wrap">\n                    ${e.homepage?`<button class="uk-button uk-button-primary d-flex flex-row" id="open">Open ${i?'<div class="new-tab ml-3"></div>':""}</button>`:""}\n                    <a href="${e.html_url}/archive/${e.default_branch}.zip" class="uk-button uk-button-secondary" id="download" download>Download</a>\n                    <button class="uk-button" id="clone">Clone</button>\n                </div>\n                <a href="https://github.com/dandycheng/${e.name}" class="uk-link pt-3" target="_blank">Open in GitHub</a>\n            </div>\n            ${c||s?'<div class="uk-divider-icon"></div><div id="readme"></div>':""}\n        `),parseMd(s?n:l,"readme",e.fork),Scrollbar.init($(".d-tree")[0],{damping:.25,renderByPixels:!0,alwaysShowTracks:!0}),e.homepage&&e.homepage.length&&$("#modal .uk-modal-body #open").click(function(){i?window.open(e.homepage,"_blank"):($("#repo-content-open iframe").attr("src",e.homepage),UIkit.notification(`<p class="text-center m-0 p-1 py-0">You are viewing: <strong id="content-name" class="d-inline-block">${e.name}</strong></p>`,{pos:"bottom-center",timeout:5e3}),$("#content-name").closest("div.uk-notification-message").toggleClass(["uk-background-secondary","uk-light"]),UIkit.modal($("#repo-content-open")).show())}),getCloneUrl(e),$("#modal .uk-modal-body #clone").click(function(){UIkit.modal($("#clone-dialog")[0]).show(),$("#clone-dialog a").click(function(){getCloneUrl(e,$(this).text())})});for(let e of o)$("#modal .d-tree .scroll-content").append(COMPONENTS.treeNode(e));t.length>0&&$("#modal .uk-modal-body .langs").html(`${t.map(e=>COMPONENTS.tag(e)).join("")} `);for(let e of $(".prettyprint ol"))$(e).children("li").length>1?Scrollbar.init(e,{damping:.25,renderByPixels:!0,alwaysShowTracks:!0}):Scrollbar.init($(e).children("li")[0],{damping:.25,renderByPixels:!0,alwaysShowTracks:!0})},1e3)}$(document).ready(async function(){mainScroll=Scrollbar.init($("main")[0],{damping:.25,renderByPixels:!0}),repoListScroll=Scrollbar.init($("#repo-list")[0],{damping:.25,renderByPixels:!0,alwaysShowTracks:!0}),Scrollbar.init($("#search-result")[0],{damping:.25,renderByPixels:!0,alwaysShowTracks:!0});let e,t=navigator.onLine,o=!1;setInterval(()=>{navigator.onLine?t||(UIkit.notification("<p class='uk-text-normal uk-text-small uk-text-center p-2 m-0'>You're back online!</p>",{pos:"bottom-center",timeout:3e3,status:"success"}),t=!t,o=!1):o||(UIkit.notification("<p class='uk-text-normal uk-text-small uk-text-center p-2 m-0'>No internet connection is detected, please check your device's connection.</p>",{pos:"bottom-center",timeout:3e3,status:"danger"}),t=!1,o=!0)},2e3),getSearchParams()&&setModalContent(await(await fetch("https://github.com/dandycheng/"))),$(window).resize(function(){a()}),$("#hide").click(function(){e=!e,a()});let n=/(\s+|[^\w+|\s+|#]|[_+|#])/g;function a(){let t={width:e?$(document.body).width():"70%"};$("#sect-right").css($(document.body).width()>1e3?t:{width:"100%"}),$("#hide").css({transform:e?"rotate(180deg)":"rotate(0deg)"}).attr("uk-tooltip",e?"Expand":"Hide")}$("#repo-search").keyup(async function(){if($("#search-result .scroll-content > div").remove(),$(this).val().length>0){$("#search-result").removeClass("d-none").addClass("pr-2 mt-3"),$("#repo-list").hide();let e=$(this).val().replace(n,"");if(e.length>0){let t=new RegExp(`${e}`,"gi");for(let e of $("#repo-list .repo-item")){let o=$(e).data("name").replace(n,""),a=$(e).data("topics").find(function(e){return t.test(e.replace(n,""))});(t.test(o)||a)&&$("#search-result .scroll-content").append(await COMPONENTS.repoItem($(e).data(),"secondary"))}$("#search-result .scroll-content div").length?$("#search-result .scroll-content > p").addClass("d-none"):$("#search-result .scroll-content > p").removeClass("d-none").text(`No results found for "${$("#repo-search").val()}"`)}else $("#search-result .scroll-content > p").removeClass("d-none").text(`No results found for "${$("#repo-search").val()}"`)}else $("#search-result").addClass("d-none").removeClass("pr-2 mt-3"),$("#repo-list").show()}),$(".uk-modal-close-full").click(function(){UIkit.notification.closeAll()}),$("#jump-to-repo-wrap").click(function(){mainScroll.scrollIntoView($("#sect-right")[0])}),$("#clone-url").click(function(){copyCloneURL()}),$(document).keydown(function(e){27===e.keyCode&&(UIkit.notification.closeAll(),$("#modal.uk-open").length||(document.title="Dandy Cheng",$("#modal .uk-modal-body").html("")))}),$(document.body).click(function(){$("#modal.uk-open").length||(document.title="Dandy Cheng",UIkit.modal($("#modal")).hide())})});